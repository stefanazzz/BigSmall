c Parameters
c     parameter (nx=  512, ny=128, npm=  12)
      parameter (nx=  1024, ny=256, npm=  12)
c
      real pi,dx,dt,tau_s,tau_f,rf,rn,rnn
      real ssini,mu_s,mu_d,peak,delta,vmax,diss
      real vcha,rvr,rvh
      integer it,nos1,nos2,is1,is2,newfail, waittime
      integer i,j,k,InitAspLen,nbr
      integer nxs,nys,ntime,numsta
      integer FractureType
      character*25 fstats
      character*5 FricType
      logical savefields,savetraces
c field variables & parameters arrays:
      real  v1(1:ny,1:nx)
      real  v2(1:ny,1:nx)     
      real s11(1:ny,1:nx)
      real s22(1:ny,1:nx)
      real s12(1:ny,1:nx)
      real  mu(1:ny,1:nx)
      real muu(1:ny,1:nx)
      real lam(1:ny,1:nx)
      real rho(1:ny,1:nx)
      real ro1(1:ny,1:nx)
      real ro2(1:ny,1:nx)
      real peak_12(1:nx)
      real strini(1:nx)
      real rdis(1:nx)
      real fault(1:ny)
      real slip(1:nx)
      integer broken(nx)
      integer itim(nx)
      integer epoints(2)
c COMMON VAR&PAR:
      common /rel/ pi,rf,rn,rnn,dt,dx,tau_s,tau_f,
     &             diss,ssini,peak,delta,vmax,mu_s,mu_d,
     &             rvr,rvh,vcha
      common /ntgr/it,nos1,nos2,is1,is2,InitAspLen,nbr
      common /ntgr2/nxs,nys,ntime,numsta,FractureType
      common /ntgrvec/broken,itim, epoints, newfail, waittime
      common /realar/v1,v2,s11,s22,s12,mu,lam,rho,muu,ro1,ro2,
     &               slip,rdis,strini,peak_12,fault
      common /chara/ fstats,FricType
      common /log/ savefields,savetraces
c LEFT BOUNDARY
      real  soL11(1:ny,1:npm+1)
      real  spL11(1:ny,1:npm+1)
      real  sL11(1:ny,1:npm+1)
      real  soL12(1:ny,1:npm+1)
      real  spL12(1:ny,1:npm+1)
      real  sL12(1:ny,1:npm+1)
      real  soL22(1:ny,1:npm+1)
      real  spL22(1:ny,1:npm+1)
      real  sL22(1:ny,1:npm+1)
      real  v1oL(1:ny,1:npm+1)
      real  v1pL(1:ny,1:npm+1)
      real  v1L(1:ny,1:npm+1)
      real  v2oL(1:ny,1:npm+1)
      real  v2pL(1:ny,1:npm+1)
      real  v2L(1:ny,1:npm+1)
      real  lamL(1:ny,1:npm+1)
      real  muL(1:ny,1:npm+1)
      real  muuL(1:ny,1:npm+1)
      real  rhoL(1:ny,1:npm+1)
      real  ro1L(1:ny,1:npm+1)
      real  ro2L(1:ny,1:npm+1)
      real  DiXvL(1:ny,1:npm+1)
      real  DiXoL(1:ny,1:npm+1)
c RIGHT BOUNDARY
      real  soR11(1:ny,1:npm+1)
      real  spR11(1:ny,1:npm+1)
      real  sR11(1:ny,1:npm+1)
      real  soR12(1:ny,1:npm+1)
      real  spR12(1:ny,1:npm+1)
      real  sR12(1:ny,1:npm+1)
      real  soR22(1:ny,1:npm+1)
      real  spR22(1:ny,1:npm+1)
      real  sR22(1:ny,1:npm+1)
      real  v1oR(1:ny,1:npm+1)
      real  v1pR(1:ny,1:npm+1)
      real  v1R(1:ny,1:npm+1)
      real  v2oR(1:ny,1:npm+1)
      real  v2pR(1:ny,1:npm+1)
      real  v2R(1:ny,1:npm+1)
      real  lamR(1:ny,1:npm+1)
      real  muR(1:ny,1:npm+1)
      real  muuR(1:ny,1:npm+1)
      real  rhoR(1:ny,1:npm+1)
      real  ro1R(1:ny,1:npm+1)
      real  ro2R(1:ny,1:npm+1)
      real  DiXvR(1:ny,1:npm+1)
      real  DiXoR(1:ny,1:npm+1)
c BOTTOM BOUNDARY
      real  soB11(1:npm+1,1:nx)
      real  spB11(1:npm+1,1:nx)
      real  sB11(1:npm+1,1:nx)
      real  soB12(1:npm+1,1:nx)
      real  spB12(1:npm+1,1:nx)
      real  sB12(1:npm+1,1:nx)
      real  soB22(1:npm+1,1:nx)
      real  spB22(1:npm+1,1:nx)
      real  sB22(1:npm+1,1:nx)
      real  v1oB(1:npm+1,1:nx)
      real  v1pB(1:npm+1,1:nx)
      real  v1B(1:npm+1,1:nx)
      real  v2oB(1:npm+1,1:nx)
      real  v2pB(1:npm+1,1:nx)
      real  v2B(1:npm+1,1:nx)
      real  lamB(1:npm+1,1:nx)
      real  muB(1:npm+1,1:nx)
      real  muuB(1:npm+1,1:nx)
      real  rhoB(1:npm+1,1:nx)
      real  ro1B(1:npm+1,1:nx)
      real  ro2B(1:npm+1,1:nx)
      real  DiYvB(1:npm+1,1:nx)
      real  DiYoB(1:npm+1,1:nx)
c BOTTOM-LEFT BOUNDARY
      real  soBL11(1:npm+1,1:npm+1)
      real  spBL11(1:npm+1,1:npm+1)
      real  sBL11(1:npm+1,1:npm+1)
      real  soBL12(1:npm+1,1:npm+1)
      real  spBL12(1:npm+1,1:npm+1)
      real  sBL12(1:npm+1,1:npm+1)
      real  soBL22(1:npm+1,1:npm+1)
      real  spBL22(1:npm+1,1:npm+1)
      real  sBL22(1:npm+1,1:npm+1)
      real  v1oBL(1:npm+1,1:npm+1)
      real  v1pBL(1:npm+1,1:npm+1)
      real  v1BL(1:npm+1,1:npm+1)
      real  v2oBL(1:npm+1,1:npm+1)
      real  v2pBL(1:npm+1,1:npm+1)
      real  v2BL(1:npm+1,1:npm+1)
      real  lamBL(1:npm+1,1:npm+1)
      real  muBL(1:npm+1,1:npm+1)
      real  muuBL(1:npm+1,1:npm+1)
      real  rhoBL(1:npm+1,1:npm+1)
      real  ro1BL(1:npm+1,1:npm+1)
      real  ro2BL(1:npm+1,1:npm+1)
      real  DiYvBL(1:npm+1,1:npm+1)
      real  DiYoBL(1:npm+1,1:npm+1)
      real  DiXvBL(1:npm+1,1:npm+1)
      real  DiXoBL(1:npm+1,1:npm+1)
c BOTTOM-RIGHT BOUNDARY
      real  soBR11(1:npm+1,1:npm+1)
      real  spBR11(1:npm+1,1:npm+1)
      real  sBR11(1:npm+1,1:npm+1)
      real  soBR12(1:npm+1,1:npm+1)
      real  spBR12(1:npm+1,1:npm+1)
      real  sBR12(1:npm+1,1:npm+1)
      real  soBR22(1:npm+1,1:npm+1)
      real  spBR22(1:npm+1,1:npm+1)
      real  sBR22(1:npm+1,1:npm+1)
      real  v1oBR(1:npm+1,1:npm+1)
      real  v1pBR(1:npm+1,1:npm+1)
      real  v1BR(1:npm+1,1:npm+1)
      real  v2oBR(1:npm+1,1:npm+1)
      real  v2pBR(1:npm+1,1:npm+1)
      real  v2BR(1:npm+1,1:npm+1)
      real  lamBR(1:npm+1,1:npm+1)
      real  muBR(1:npm+1,1:npm+1)
      real  muuBR(1:npm+1,1:npm+1)
      real  rhoBR(1:npm+1,1:npm+1)
      real  ro1BR(1:npm+1,1:npm+1)
      real  ro2BR(1:npm+1,1:npm+1)
      real  DiYvBR(1:npm+1,1:npm+1)
      real  DiYoBR(1:npm+1,1:npm+1)
      real  DiXvBR(1:npm+1,1:npm+1)
      real  DiXoBR(1:npm+1,1:npm+1)
c TOP BOUNDARY
      real  soT11(1:npm+1,1:nx)
      real  spT11(1:npm+1,1:nx)
      real  sT11(1:npm+1,1:nx)
      real  soT12(1:npm+1,1:nx)
      real  spT12(1:npm+1,1:nx)
      real  sT12(1:npm+1,1:nx)
      real  soT22(1:npm+1,1:nx)
      real  spT22(1:npm+1,1:nx)
      real  sT22(1:npm+1,1:nx)
      real  v1oT(1:npm+1,1:nx)
      real  v1pT(1:npm+1,1:nx)
      real  v1T(1:npm+1,1:nx)
      real  v2oT(1:npm+1,1:nx)
      real  v2pT(1:npm+1,1:nx)
      real  v2T(1:npm+1,1:nx)
      real  lamT(1:npm+1,1:nx)
      real  muT(1:npm+1,1:nx)
      real  muuT(1:npm+1,1:nx)
      real  rhoT(1:npm+1,1:nx)
      real  ro1T(1:npm+1,1:nx)
      real  ro2T(1:npm+1,1:nx)
      real  DiYvT(1:npm+1,1:nx)
      real  DiYoT(1:npm+1,1:nx)
c TOP-LEFT BOUNDARY
      real  soTL11(1:npm+1,1:npm+1)
      real  spTL11(1:npm+1,1:npm+1)
      real  sTL11(1:npm+1,1:npm+1)
      real  soTL12(1:npm+1,1:npm+1)
      real  spTL12(1:npm+1,1:npm+1)
      real  sTL12(1:npm+1,1:npm+1)
      real  soTL22(1:npm+1,1:npm+1)
      real  spTL22(1:npm+1,1:npm+1)
      real  sTL22(1:npm+1,1:npm+1)
      real  v1oTL(1:npm+1,1:npm+1)
      real  v1pTL(1:npm+1,1:npm+1)
      real  v1TL(1:npm+1,1:npm+1)
      real  v2oTL(1:npm+1,1:npm+1)
      real  v2pTL(1:npm+1,1:npm+1)
      real  v2TL(1:npm+1,1:npm+1)
      real  lamTL(1:npm+1,1:npm+1)
      real  muTL(1:npm+1,1:npm+1)
      real  muuTL(1:npm+1,1:npm+1)
      real  rhoTL(1:npm+1,1:npm+1)
      real  ro1TL(1:npm+1,1:npm+1)
      real  ro2TL(1:npm+1,1:npm+1)
      real  DiYvTL(1:npm+1,1:npm+1)
      real  DiYoTL(1:npm+1,1:npm+1)
      real  DiXvTL(1:npm+1,1:npm+1)
      real  DiXoTL(1:npm+1,1:npm+1)
c TOP-RIGHT BOUNDARY
      real  soTR11(1:npm+1,1:npm+1)
      real  spTR11(1:npm+1,1:npm+1)
      real  sTR11(1:npm+1,1:npm+1)
      real  soTR12(1:npm+1,1:npm+1)
      real  spTR12(1:npm+1,1:npm+1)
      real  sTR12(1:npm+1,1:npm+1)
      real  soTR22(1:npm+1,1:npm+1)
      real  spTR22(1:npm+1,1:npm+1)
      real  sTR22(1:npm+1,1:npm+1)
      real  v1oTR(1:npm+1,1:npm+1)
      real  v1pTR(1:npm+1,1:npm+1)
      real  v1TR(1:npm+1,1:npm+1)
      real  v2oTR(1:npm+1,1:npm+1)
      real  v2pTR(1:npm+1,1:npm+1)
      real  v2TR(1:npm+1,1:npm+1)
      real  lamTR(1:npm+1,1:npm+1)
      real  muTR(1:npm+1,1:npm+1)
      real  muuTR(1:npm+1,1:npm+1)
      real  rhoTR(1:npm+1,1:npm+1)
      real  ro1TR(1:npm+1,1:npm+1)
      real  ro2TR(1:npm+1,1:npm+1)
      real  DiYvTR(1:npm+1,1:npm+1)
      real  DiYoTR(1:npm+1,1:npm+1)
      real  DiXvTR(1:npm+1,1:npm+1)
      real  DiXoTR(1:npm+1,1:npm+1)
c COMMON BLOCK OPERATING      
      common /left/soL11,spL11,sL11,soL12,spL12,sL12,soL22,
     & spL22,sL22,v1oL,v1pL,v1L,v2oL,v2pL,v2L,
     & muL,rhoL,lamL,muuL,ro1L,ro2L,DiXvL,DiXoL
      common /right/soR11,spR11,sR11,soR12,spR12,sR12,soR22,
     & spR22,sR22,v1oR,v1pR,v1R,v2oR,v2pR,v2R,
     & muR,rhoR,lamR,muuR,ro1R,ro2R,DiXoR,DiXvR
      common /bottom/soB11,spB11,sB11,soB12,spB12,sB12,soB22,
     & spB22,sB22,v1oB,v1pB,v1B,v2oB,v2pB,v2B,
     & muB,rhoB,lamB,muuB,ro1B,ro2B,DiYvB,DiYoB
      common /bottomleft/soBL11,spBL11,sBL11,soBL12,spBL12,sBL12,soBL22,
     & spBL22,sBL22,v1oBL,v1pBL,v1BL,v2oBL,v2pBL,v2BL,
     & muBL,rhoBL,lamBL,muuBL,ro1BL,ro2BL,
     & DiXoBL,DiXvBL,DiYoBL,DiYvBL
      common /bottomright/soBR11,spBR11,sBR11,soBR12,spBR12,sBR12,
     & soBR22,spBR22,sBR22,v1oBR,v1pBR,v1BR,v2oBR,v2pBR,v2BR,
     & muBR,rhoBR,lamBR,muuBR,ro1BR,ro2BR, 
     & DiXoBR,DiXvBR,DiYoBR,DiYvBR
      common /top/soT11,spT11,sT11,soT12,spT12,sT12,soT22,
     & spT22,sT22,v1oT,v1pT,v1T,v2oT,v2pT,v2T,
     & muT,rhoT,lamT,muuT,ro1T,ro2T,DiYvT,DiYoT
      common /topleft/soTL11,spTL11,sTL11,soTL12,spTL12,sTL12,soTL22,
     & spTL22,sTL22,v1oTL,v1pTL,v1TL,v2oTL,v2pTL,v2TL,
     & muTL,rhoTL,lamTL,muuTL,ro1TL,ro2TL,
     & DiXoTL,DiXvTL,DiYoTL,DiYvTL
      common /topright/soTR11,spTR11,sTR11,soTR12,spTR12,sTR12,
     & soTR22,spTR22,sTR22,v1oTR,v1pTR,v1TR,v2oTR,v2pTR,v2TR,
     & muTR,rhoTR,lamTR,muuTR,ro1TR,ro2TR, 
     & DiXoTR,DiXvTR,DiYoTR,DiYvTR
